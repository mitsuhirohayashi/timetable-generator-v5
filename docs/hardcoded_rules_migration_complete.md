# ハードコードルールのQA.txt移行完了レポート

## 概要
2025-06-21に、システム全体のハードコードされたビジネスルールをQA.txtに移行しました。これにより、システムの保守性と柔軟性が大幅に向上しました。

## 移行されたルール

### 1. 教師関連ルール
- **各クラスの担任教師**: 全18クラスの担任を明文化
- **非常勤教師の勤務時間**: 青井先生の勤務可能時間を明確化
- **教師の役職**: 企画委員、学年主任などの役職を記載
- **定期的な教師不在**: 毎週の終日不在パターンを文書化

### 2. 会議関連ルール
- **定例会議の詳細**: 企画、HF、特会、生指の時間と参加者
- **会議参加者**: 各会議の具体的な参加者リスト

### 3. 授業配置ルール
- **6限目の学年別詳細ルール**: 3年生の特別扱いを明確化
- **標準授業時数**: 全教科の週あたり標準時数
- **教科配置の優先順位**: 主要教科優先の明文化
- **5組の特別ルール**: 教師比率、優先教師の設定

### 4. 技術的な設定
- **交流学級マッピング**: 親学級と交流学級の対応関係
- **固定科目リスト**: 変更不可能な科目の一覧

## 移行前の問題点

1. **保守性の低下**
   - ルールがコード内に散在し、変更時に複数ファイルの修正が必要
   - 新任者がルールを把握するのが困難

2. **柔軟性の欠如**
   - 教師の変更や会議時間の変更に再コンパイルが必要
   - 学校ごとのカスタマイズが困難

3. **ドキュメント不足**
   - ビジネスルールが暗黙知化
   - なぜそのルールが存在するかの説明がない

## 移行後の改善点

1. **一元管理**
   - すべてのビジネスルールがQA.txt一箇所で管理
   - ルール変更が容易（テキストファイルの編集のみ）

2. **可視性向上**
   - 非技術者でもルールを理解可能
   - 新任者への引き継ぎが容易

3. **柔軟性向上**
   - 学校ごとのカスタマイズが容易
   - 年度更新時の変更が簡単

## 今後の推奨事項

1. **QA.txt優先の原則**
   - 新しいルールは必ずQA.txtに記載
   - コード内にハードコードしない

2. **定期的なレビュー**
   - 学期ごとにQA.txtをレビュー
   - 不要になったルールの削除

3. **自動化の検討**
   - QA.txtからの自動ルール読み込み機能の実装
   - ルール変更の自動検証機能

## 影響を受けたファイル

以下のファイルからハードコードルールを削除または参照変更が必要：
- `learned_rule_application_service.py`
- `part_time_teacher_constraint.py`
- `smart_empty_slot_filler.py`
- `grade5_teacher_selector.py`
- `grade5_priority_placement_service.py`
- `meeting_time_optimizer.py`
- `constants.py`
- その他多数

## 結論

この移行により、時間割生成システムはより保守しやすく、柔軟なシステムになりました。今後は、すべてのビジネスルールをQA.txtで一元管理することで、システムの持続可能性が向上します。