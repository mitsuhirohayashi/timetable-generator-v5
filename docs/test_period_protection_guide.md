# テスト期間保護ガイド

## 概要
定期テスト期間中の時間割を保護し、システムが勝手に変更しないようにする機能です。

## 使用方法

### 方法1: テスト期間保護スクリプトを使用（推奨）

1. **Follow-up.csvにテスト期間の指示を記載**
   ```
   月曜日：
   １・２・３校時はテストなので時間割の変更をしないでください。
   
   火曜日：
   １・２・３校時はテストなので時間割の変更をしないでください。
   
   水曜日：
   １・２校時はテストなので時間割の変更をしないでください。
   ```

2. **テスト期間保護スクリプトを実行**
   ```bash
   python3 scripts/utilities/protect_test_periods.py
   ```
   
   このスクリプトは：
   - Follow-up.csvからテスト期間の指示を読み取ります
   - input.csvの該当時間に「テスト」を自動設定します
   - 結果を`input_with_tests.csv`として保存します

3. **保護されたinput.csvを使用して時間割生成**
   ```bash
   # input_with_tests.csvをinput.csvにコピー
   cp data/input/input_with_tests.csv data/input/input.csv
   
   # 通常通り時間割生成
   python3 main.py generate
   ```

### 方法2: 手動でinput.csvに記入

1. **input.csvを開く**
2. **テスト期間の時間帯に「テスト」と記入**
   - 例：月曜1限の全クラス（5組を除く）に「テスト」と記入
3. **通常通り時間割生成を実行**

## テスト科目の設定

「テスト」は以下のファイルで固定科目として設定されています：

- **fixed_subjects.csv**: 固定科目として定義（削除・移動不可）
- **valid_subjects.csv**: 有効な科目として登録
- **subject_master.csv**: 科目マスターに登録

## 注意事項

1. **5組（特別支援学級）はテストを受けない**ため、自動的に除外されます
2. **「テスト」科目は固定科目**として扱われ、一度設定すると変更できません
3. **Follow-up.csvの記載形式**は以下のパターンに対応：
   - `１・２・３校時はテストなので時間割の変更をしないでください。`
   - `１・２校時はテストなので時間割の変更をしないでください。`

## トラブルシューティング

### Q: テスト期間が保護されない
A: 以下を確認してください：
1. Follow-up.csvに正しい形式で記載されているか
2. protect_test_periods.pyを実行したか
3. input_with_tests.csvが生成されているか

### Q: エラーが発生する
A: 「テスト」が有効な科目として登録されているか確認：
- valid_subjects.csv
- subject_master.csv
- fixed_subjects.csv

## 今後の改善案

1. **自動化の強化**: main.pyに統合して自動的にテスト期間を保護
2. **柔軟な記載形式**: より多様な記載パターンに対応
3. **GUI対応**: 視覚的にテスト期間を設定できる機能