# 📚 時間割生成システム - Q&Aマネジメント
==========================================

このファイルは時間割生成システムの質問と回答を管理します。
視覚的に整理され、ステータス管理機能を備えています。

最終更新: 2025-06-21 12:30:00
==========================================


## 🔴 未回答の質問（要対応）
-----------------------------------
※ これらの質問に回答してください

✨ 現在、未回答の質問はありません。


## ✅ 解決済みの質問（履歴）
-----------------------------------
※ 解決された質問の記録（最新10件）

[2025-06-17] 🟡 高優先度 | 📁 教師配置
**Q: 井上先生が火曜5限に2-1, 2-2, 2-3の3クラスで数学を同時に教えることはできませんが、どのように対処すべきですか？**
A: 火曜の5時間目を見たところ2−1と2−2に数学が入っています。どちらかの数学を移動させて対応して下さい。
→ ✅ 基本ルール違反の例：教師は同時に1クラスしか担当できない

---

[2025-06-17] 🟢 中優先度 | 📁 テスト期間
**Q: テスト期間中の体育（保体）はどのように実施されますか？**
A: 体育の定期テストは筆記試験のため、各教室で実施されます。したがって、体育館使用制限は適用されず、複数クラスが同時に「保体」を持つことができます。

---

[2025-06-17] 🟢 中優先度 | 📁 交流学級
**Q: 3年6組の自立活動には特別なルールがありますか？**
A: はい。3年6組は3年3組が「数学」または「英語」の時のみ自立活動が可能です（ただし、テストの時間の数学や英語の時は自立はできません。）。

---


## 📌 恒久的ルール（常に適用）
-----------------------------------
※ システムが常に参照するルール

### 🏫 担任教師の担当科目ルール
各クラスの担任教師は以下の科目を担当します：
- 学活（学）
- 総合（総、総合）
- 学総（学年総合）
- YT（特別活動）

### ⚠️ 固定科目の保護
以下の科目は絶対に変更してはいけません：
- 欠（欠課）
- YT（特別活動）
- 学、学活（学級活動）
- 総、総合（総合的な学習の時間）
- 道、道徳（道徳）
- 学総（学年総合）
- 行、行事（行事）
- テスト（定期テスト）
- 技家（技術・家庭科合併テスト）

### 🏃 5組の合同授業
5組（1-5, 2-5, 3-5）は全教科で3クラス合同授業を行うため、
1人の教師が3クラスを同時に担当します。これは制約違反ではありません。

### 🏫 教師の重複制約
**基本原則（物理的制約）**：
- 教師は同じ時間に複数のクラスを同時に教えることはできません
- これは全ての教師・全ての時間帯に適用される絶対的な制約です
- 1人の教師が同時に複数の場所に存在することは物理的に不可能

**例外（正常な運用）**：
- 5組の合同授業（3クラスが同じ場所で合同授業）
- テスト期間中（教師が複数教室を巡回監督）

### 🏫 施設使用制限
**体育館**：
- 同時刻に使用できるのは1クラスのみ
- 例外5組の合同授業、テスト期間

**保0表記について（2025-06-22追加）**：
- 「保0」や「保0×」は、その時間帯に保健体育が1つも配置されていないことを示す
- これはエラーや制約違反ではない
- 体育館が空いている時間帯を示す情報表記

### 📚 交流学級のルール
**親学級との対応関係**：
- 1年6組 ← 1年1組
- 1年7組 ← 1年2組
- 2年6組 ← 2年3組
- 2年7組 ← 2年2組
- 3年6組 ← 3年3組
- 3年7組 ← 3年2組

**自立活動の条件**：
- 親学級が「数学」または「英語」の時のみ配置可能
- 3年6組特別ルール：テスト時間中は不可

### 📅 科目配置の基本ルール
- **1日1コマ制限**：同じ科目を1日に複数回配置しない
- **授業時数**：`base_timetable.csv`の標準時数を遵守
- **優先時間帯**：主要教科は午前中が望ましい（必須ではない）

### 📢 会議・教師不在
**定例会議**（基本、Follow-up.csv優先）：
- HF（火曜4限）
- 企画（火曜3限）
- 特会（水曜2限）
- 生指（木曜3限）

### 📝 テスト期間のルール
テスト期間中は以下のルールが適用されます：
- 時間割の変更は原則禁止
- **1名の教科担当者がその教科のテストを巡回監督**
- 教師は巡回監督のため複数クラスを担当可能
- 体育の筆記試験は各教室で実施（体育館制限なし）
- **重要：テスト期間中の教師重複は制約違反としない**

### 🔑 空きスロット埋め時の交流学級同期ルール（2025-06-21追加）
**重要：空きスロットを埋める際は交流学級の同期を必ず維持する**
- 手動埋めスクリプトや自動埋め機能を使用する際、交流学級（6組・7組）の同期を必ず考慮する
- 交流学級の空きスロットを埋める際は、必ず親学級と同じ科目を配置する
- 親学級の空きスロットを埋める際は、交流学級も同時に同じ科目で埋める

**実装要件**：
1. 空きスロット埋めスクリプトは交流学級マッピングを読み込む
2. 交流学級または親学級の空きを埋める際は、ペアも同時に処理
3. 自立活動の時間は除外（交流学級独自の授業のため）
4. 既に配置済みの授業との整合性を確認

**違反例**：
- 3年3組（親学級）に「国」を配置したが、3年6組（交流学級）に「保」を配置 ❌
- 正しい対応：両方に「国」を配置するか、両方とも空きのままにする ✅

### 🎯 5組の国語教師割り当てルール（2025-06-21追加）
**5組（1-5、2-5、3-5）の国語は寺田先生か金子み先生のどちらか**
- 基本的に金子み先生を優先的に配置
- 金子み先生が配置できない場合（他クラスとの重複等）は寺田先生を配置
- 理想的には週全体で寺田先生と金子み先生の比率を1:1に近づける

**実装要件**：
1. teacher_subject_mapping.csvに金子み先生の国語担当を追加
2. 5組の国語配置時に以下の優先順位で処理：
   - 第1優先：金子み先生（他クラスと重複しない場合）
   - 第2優先：寺田先生
3. 週間での比率管理：
   - 3クラス合同なので、週4コマの国語授業
   - 理想：金子み先生2コマ、寺田先生2コマ
   - 制約違反を避けるため、柔軟に調整可能

**配置例**：
- 月曜2限 国語（1-5,2-5,3-5）：金子み先生
- 水曜4限 国語（1-5,2-5,3-5）：寺田先生
- 木曜2限 国語（1-5,2-5,3-5）：金子み先生
- 金曜3限 国語（1-5,2-5,3-5）：寺田先生

### 🏫 各クラスの担任教師（2025-06-21追加）
**通常学級**：
- 1年1組：金子ひ先生
- 1年2組：井野口先生
- 1年3組：梶永先生
- 2年1組：塚本先生
- 2年2組：野口先生
- 2年3組：永山先生
- 3年1組：白石先生
- 3年2組：森山先生
- 3年3組：北先生

**特別支援学級**：
- 1年5組、2年5組、3年5組：金子み先生
- 1年6組、2年6組、3年6組：財津先生
- 1年7組、2年7組、3年7組：智田先生

### 🕐 非常勤教師の勤務時間（2025-06-21追加）
**青井先生（美術）**：
- 水曜：2、3、4校時
- 木曜：1、2、3校時
- 金曜：2、3、4校時
- ※上記以外の時間は勤務できません

### 🏢 定例会議の詳細（2025-06-21追加）
**企画会議**：
- 時間：火曜3限
- 参加者：校長、教頭、青井、児玉（養護教諭）、吉村（事務職員）

**HF会議**：
- 時間：火曜4限
- 参加者：校長、教頭、青井、児玉（養護教諭）、吉村（事務職員）

**特別支援会議（特会）**：
- 時間：水曜2限
- 参加者：関係教員

**生徒指導会議（生指）**：
- 時間：木曜3限
- 参加者：校長、教頭、生徒指導主任（児玉・養護教諭）

### 🚨 エラー防止のための恒久的ルール（2025-06-23追加）

**1. 教師不在情報の確実な反映**：
- Follow-up.csvの教師不在情報は必ず反映される
- TeacherAbsenceLoaderの`teacher_absences`プロパティ経由で正しい形式で提供
- ConstraintValidatorに渡される前にデータ形式を統一

**2. 交流学級の双方向チェック**：
- 交流学級に自立活動を配置する前に、親学級が数学・英語であることを必ず確認
- 親学級の科目を変更する前に、交流学級が自立活動でないことを必ず確認
- `can_place_jiritsu_for_exchange_class`と`can_change_parent_class_subject`メソッドで事前検証

**3. キャッシュ管理の徹底**：
- スケジュール更新時は必ずConstraintValidatorのキャッシュをクリア
- `clear_cache()`メソッドを更新後に必ず呼び出す
- 古いデータによる誤った制約チェックを防止

**4. データ連携の標準化**：
- すべてのデータ交換は明確なインターフェースを定義
- 属性名とデータ形式を統一（例：teacher_absencesプロパティ）
- 後方互換性を保つため必要に応じてアダプターパターンを使用

詳細な実装方法と原因分析は`docs/error_prevention_rules_and_strategies.md`を参照

### 👨‍🏫 職員の役職（2025-06-22改訂）
- 青井先生：企画委員、3年主任（授業担当）
- 児玉先生：企画委員、生徒指導主任、養護教諭（授業なし）
- 吉村先生（1年主任）：企画委員、1年主任（授業担当）
- 吉村先生（事務職員）：企画委員、事務職員（授業なし）

### 👩‍🏫 初任者教員情報（2025-06-25追加）
**初任者教員**：
- 井野口先生（1年2組担任、英語担当）
- 毎週金曜日2時間目は初任者研修のため授業不可
- 校長先生からの初任者研修を受ける

### 📅 教師の定期的な不在（2025-06-21追加）
**毎週の終日不在**：
- 月曜：井野口先生
- 火曜：智田先生
- 水曜：北先生
- 木曜：白石先生
- 金曜：校長、森山先生

### ⏰ 6限目の学年別詳細ルール（2025-06-21追加）
**3年生（通常学級：3-1、3-2、3-3）**：
- 月曜6限：通常授業可能
- 火曜6限：通常授業可能
- 水曜6限：通常授業可能
- 金曜6限：YT（特別活動）

**1・2年生、交流学級、5組**：
- 月曜6限：欠（欠課）
- 火曜6限：YT（特別活動）
- 水曜6限：YT（特別活動）
- 金曜6限：YT（特別活動）

### 📊 標準授業時数（週あたり）（2025-06-21追加）
**主要5教科**：
- 国語：4時間
- 数学：3時間（3年生は「数」）
- 英語：4時間
- 理科：3時間
- 社会：3時間

**技能教科**：
- 音楽：1時間
- 美術：1時間
- 保健体育：3時間（表記は「保」）
- 技術：1時間
- 家庭：1時間

**その他**：
- 道徳：1時間
- 総合的な学習の時間：2時間
- 学級活動：1時間

### 📚 教科配置の優先順位（2025-06-21追加）
**空きスロットを埋める際の優先順位**：
1. 主要教科（算、国、理、社、英、数）を最優先
2. 標準時数の多い教科から順に配置
3. 技能教科は後回し
4. 固定科目（欠、YT、学、総、道、学総）は新規配置しない

### 🎯 5組の教師優先配置（2025-06-21追加）
**5組優先教師**：
- 金子み先生を優先的に5組の授業に配置
- 特に国語、美術、日生、作業などで優先

### 📋 技家（技術・家庭科）の担当教師（2025-06-21追加）
**技家の担当**：
- 林先生：全クラスの技術・家庭科を担当
- 金子み先生：全クラスの技術・家庭科を担当
- ※技家は合併テストのため、両教師が担当として登録される

### 📝 5組国語の特殊ケース（2025-06-21追加）
**寺田先生・金子み先生の特別ルール**：
- 5組（1-5、2-5、3-5）の国語を担当する場合、他の通常学級の国語も同時に担当可能
- これは制約違反ではなく、特別に許可されたケース

### 🚨 職員リスト - 絶対厳守（2025-06-22改訂）
**システムで使用できる職員は以下の26名のみです。絶対に新しい職員名を作成してはいけません。**

**授業担当教師（24名）** - これらの教師のみが授業を担当できます：
1. 金子ひ（担任：1-1）
2. 井野口（担任：1-2）
3. 梶永（担任：1-3）
4. 塚本（担任：2-1）
5. 野口（担任：2-2）
6. 永山（担任：2-3）
7. 白石（担任：3-1）
8. 森山（担任：3-2）
9. 北（担任：3-3）
10. 金子み（担任：1-5, 2-5, 3-5）
11. 財津（担任：1-6, 2-6, 3-6）
12. 智田（担任：1-7, 2-7, 3-7）
13. 寺田（国語）
14. 小野塚（国語）
15. 蒲地（社会）
16. 井上（数学）
17. 青井（美術・非常勤）
18. 林（技術）
19. 箱崎（英語）
20. 林田（英語）
21. 校長（管理職・授業も担当可）
22. 教頭（管理職・授業も担当可）
23. 吉村（1年主任・授業も担当可）
24. 財津（※上記11番と同一人物）

**非授業担当職員（2名）** - 会議には参加するが授業は担当しません：
25. 児玉（養護教諭・生徒指導主任）
26. 吉村（事務職員）※上記23番の吉村先生とは別人

**絶対厳守ルール**：
- ❌ 上記リスト以外の職員名を絶対に作成・使用してはいけません
- ❌ 「田中」「佐藤」「高橋」など、実在しない職員名を勝手に作ってはいけません
- ❌ 「欠課先生」「未定先生」「TBA」などの仮想教師は使用禁止です
- ❌ 児玉先生（養護教諭）と吉村先生（事務職員）に授業を割り当ててはいけません
- ✅ 教師の重複が発生した場合は、授業担当教師（24名）の中で再配置を行う
- ✅ どうしても解決できない場合は「解決不可能」として報告する
- ✅ 児玉先生と吉村先生は会議（企画、HF等）には参加できますが、授業は担当しません

**システム要件**：
1. teacher_subject_mapping.csvに存在しない教師名は使用禁止
2. 新規教師の追加は管理者権限が必要（システムでは不可）
3. 教師重複エラーは既存教師の再配置でのみ解決
4. 解決不可能な場合はエラーメッセージで報告

### 📚 授業担当教師配置完全版（2025-06-22改訂）
**各教科の担当教師一覧**（児玉先生・吉村先生は授業担当不可）：

**国語**：
- 1-1, 1-2, 1-3, 2-1：寺田
- 2-2, 2-3, 3-1, 3-2, 3-3：小野塚
- 1-5, 2-5, 3-5：寺田（※金子みとの選択制）

**社会**：
- 1-1, 1-3, 1-5, 2-1, 2-2, 2-3, 2-5, 3-5：蒲地
- 1-2, 3-1, 3-2, 3-3：北

**数学**：
- 1-1, 1-2, 1-3, 1-5, 2-5, 3-5：梶永
- 2-1, 2-2, 2-3：井上
- 3-1, 3-2, 3-3：森山

**理科**：
- 1-1, 1-2, 1-3, 2-3：金子ひ
- 1-5, 2-1, 2-2, 2-5, 3-5：智田
- 3-1, 3-2, 3-3：白石

**音楽**：
- 全クラス：塚本

**美術**：
- 1-1, 1-2, 1-3, 2-1, 2-2, 2-3, 3-1, 3-2, 3-3：青井
- 1-5, 2-5, 3-5：金子み

**保健体育**：
- 1-1, 1-2, 2-3：永山
- 1-3, 1-5, 2-1, 2-2, 2-5, 3-5：野口
- 3-1, 3-2, 3-3：財津

**技術**：
- 全クラス：林

**家庭**：
- 全クラス：金子み

**英語**：
- 1-1, 1-2, 1-3：井野口
- 1-5, 2-5, 3-1, 3-2, 3-3, 3-5：林田
- 2-1, 2-2, 2-3：箱崎

**特別支援学級の特別教科**：
- 自立（1-5, 2-5, 3-5）：金子み
- 自立（1-6, 2-6, 3-6）：財津
- 自立（1-7, 2-7, 3-7）：智田
- 日生、作業、生単（1-5, 2-5, 3-5）：金子み

**特別教科（担任が担当）**：
- 総合、学活、道徳、学総、YT：各クラスの担任

**技家（テスト期間）**：
- 全クラス：林・金子み（両名が担当として登録）

### 🚫 制約違反の正常パターン（2025-06-22追加）
**以下は制約違反ではなく正常な運用**：

1. **テスト期間の教師巡回監督**
   - テスト期間中は1名の教科担当者がその教科を巡回監督する
   - 同一学年・同一科目で複数クラスを1人の教師が担当
   - 例：月曜1限に林先生が1年生全クラスの技家テストを巡回監督
   - **重要**：テスト期間中の教師重複は制約違反としない

2. **5組の合同授業**
   - 1-5、2-5、3-5の3クラスを1人の教師が同時に担当
   - 全教科で3クラス合同授業を実施

3. **交流学級と親学級の体育同時実施**
   - 親学級と交流学級が同じ時間に体育館で体育を実施
   - 例：3年3組と3年6組が同時に保健体育

4. **財津先生・智田先生の自立活動重複**
   - 同じ教師が複数の交流学級で自立活動を担当（やむを得ない場合）
   - 推奨されないが時間割の制約上許容


## 📦 アーカイブ（参考情報）
-----------------------------------
※ 古い解決済み質問（参考用）

（アーカイブされた質問はありません）


==========================================
このファイルは自動的に管理されています。
手動で編集する場合は、フォーマットを維持してください。
